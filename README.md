# Auto Summarization Service

Сервис выполняет загрузку документов и интеллектуальный анализ текста: извлечение объектов, оценку тональности, тематическую классификацию и генерацию краткой/полной суммаризации на русском языке.

## Запуск локально

```bash
cp example.env .env
docker compose up --build
```

После запуска API доступно по адресу `http://localhost:8000`, документация — `http://localhost:8000/docs`.

## Переменные окружения

Основные переменные определены в `.env`:

| Переменная | Назначение |
| --- | --- |
| `AUTO_SUMMARIZATION_URL_PREFIX` | Префикс REST API (по умолчанию `/v1`). |
| `AUTO_SUMMARIZATION_API_HOST` / `AUTO_SUMMARIZATION_API_PORT` | Хост и порт приложения. |
| `AUTO_SUMMARIZATION_DB_*` | Параметры подключения к PostgreSQL. |
| `AUTO_SUMMARIZATION_SUPPORTED_FORMATS` | Форматы файлов, поддерживаемые загрузчиком документов. |
| `AUTO_SUMMARIZATION_ANALYZE_TYPES_FILE` | Путь к файлу `analyze_types.json`, монтируемому в контейнер. |
| `AUTO_SUMMARIZATION_HF_MODEL_PATH` | Каталог с моделью `joeddav/xlm-roberta-large-xnli`. |
| `AUTO_SUMMARIZATION_OPENAI_MODEL` | Имя универсальной модели OpenAI для классификации. |
| `OPENAI_API_HOST` / `OPENAI_API_KEY` | Параметры доступа к универсальной модели. |

## Структура API

- `POST /v1/load_document` – принимает файл (форматы `txt`, `doc`, `docx`, `pdf`, `odt`) и возвращает извлечённый текст.
- `GET /v1/analyze_types` – список доступных категорий и типов анализа, загружаемых из `analyze_types.json` в БД.
- `POST /v1/analyze` – выполняет выбранные типы анализа для текста и возвращает найденные сущности, оценку тональности, классификацию и суммаризацию.

## Подготовка данных анализа

Файл `analyze_types.json` хранит описание категорий и связанных с ними типов анализа. Он монтируется в контейнер и при запуске сервиса загружается в базу данных вместо таблицы моделей. Для модели `joeddav/xlm-roberta-large-xnli` необходимо смонтировать скачанные файлы в каталог `huggingface/xlm-roberta-large-xnli`. Классификация текста выполняется через универсальную модель OpenAI (при наличии ключа) либо локально загруженную предобученную модель, с автоматическим переходом на эвристики при отсутствии необходимых ресурсов.
